<!DOCTYPE html><html lang="ja-JP"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Core"><title>.NET Core 2.0 PreviewとVisual Studio Codeでコンソールアプリをつくる 準備&作成編 · A certain engineer "COMPLEX"</title><meta name="description" content="Introduction2017/04/23現在、**.NET Core 2.0**の開発が進められます。 そんな.NET Core 2.0のPreviewを使ってコンソールアプリを作ります。 目標は

Visual Studio Codeを使えるようになる
.NET Coreを使えるようになる
L"><meta name="keywords"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="stylesheet" href="/css/blogcard.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><script src="/js/jquery.js"></script><meta name="generator" content="Hexo 5.1.0"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">A certain engineer &quot;COMPLEX&quot;</a></h3><div class="description"><p>とある技術者の劣等感</p></div></div></div><ul class="social-links"><li><a target="_blank" rel="noopener" href="https://github.com/takuya-takeuchi"><i class="fa fa-github"></i></a></li><li><a target="_blank" rel="noopener" href="https://twitter.com/takuya_takeuchi"><i class="fa fa-twitter-square"></i></a></li><li><a target="_blank" rel="noopener" href="https://www.facebook.com/takuya.takeuchi.sns"><i class="fa fa-facebook-square"></i></a></li></ul><div class="footer"><div class="p"> <span>© 2020 </span><i class="fa fa-star"></i><span> Core</span></div><div class="by_farbox"><span>Powered by </span><a href="https://hexo.io/" target="_blank">Hexo </a><span> & </span><a href="https://github.com/mrcore/hexo-theme-Anatole-Core" target="_blank">Anatole-Core  </a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="search"><div class="text"><input placeholder="検索ワードを入力してください" id="search-text" onkeypress="javascript:search(event)"></div><div class="btn"><a><i class="fa fa-search"></i></a></div></div><div class="nav"><li><a href="/">ホーム</a></li><li><a href="/archives">アーカイブ</a></li><li><a href="/tags">タグ</a></li><li><a href="/about">自己紹介</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>.NET Core 2.0 PreviewとVisual Studio Codeでコンソールアプリをつくる 準備&amp;作成編</a></h3></div><div class="post-content"><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>2017/04/23現在、**.NET Core 2.0**の開発が進められます。 そんな.NET Core 2.0のPreviewを使ってコンソールアプリを作ります。 目標は</p>
<ul>
<li>Visual Studio Codeを使えるようになる</li>
<li>.NET Coreを使えるようになる</li>
<li>Linuxでビルドして実行</li>
</ul>
<p>になります。 特にLinuxでの実行が重要になります。 開発環境を広げないと、飯の種が無くなってしまいますので。 今回は準備と作成を。</p>
<h1 id="NET-Core-2-0-Preview"><a href="#NET-Core-2-0-Preview" class="headerlink" title=".NET Core 2.0 Preview"></a>.NET Core 2.0 Preview</h1><p>まずは.NET Coreを入手します。 入手先は下記。 </p>
<div class="blog-card"><div class="hbc-link-wrap"><a class="hbc-link" href="https://github.com/dotnet/cli" target="_blank" rel="nofollow"><div class="hbc-card"><div class="hbc-info"><img class="hbc-favicon" src="http://www.google.com/s2/favicons?domain=github.com"></img><div class="hbc-site-name">GitHub</div></div><div class="hbc-contents"><div class="hbc-thumbnail"><img src="https://avatars0.githubusercontent.com/u/9141961?s=400&v=4"></img></div><div class="hbc-text"><div class="hbc-title">dotnet/cli</div><div class="hbc-url">https://github.com/dotnet/cli</div><div class="hbc-description">The .NET Core command-line (CLI) tools, used for building .NET Core apps and libraries through your development flow (compiling, NuGet packa…</div></div></div></div></a></div></div>

<p>上のページで、<strong>Installers and Binaries</strong>ってセクションから環境に応じたものを入手します。 今回は、zipで入手します。Previewなんて先行版をインストーラでインストールしたくありません(ｷﾘｯ) これは適当な場所に置いておきます。今回は<strong>D:\Works\Lib\Microsoft.NET Core CLI\2.0.0-preview2-005840\bin</strong>に展開します。 パスを通すかはお好みで。</p>
<h1 id="Visual-Studio-Code"><a href="#Visual-Studio-Code" class="headerlink" title="Visual Studio Code"></a>Visual Studio Code</h1><h2 id="入手"><a href="#入手" class="headerlink" title="入手"></a>入手</h2><p>ダウンロード先は下記です。以上。 </p>
<div class="blog-card"><div class="hbc-link-wrap"><a class="hbc-link" href="https://code.visualstudio.com/download" target="_blank" rel="nofollow"><div class="hbc-card"><div class="hbc-info"><img class="hbc-favicon" src="http://www.google.com/s2/favicons?domain=code.visualstudio.com"></img><div class="hbc-site-name">code.visualstudio.com</div></div><div class="hbc-contents"><div class="hbc-thumbnail"><img src="https://code.visualstudio.com/opengraphimg/opengraph-home.png"></img></div><div class="hbc-text"><div class="hbc-title">Download Visual Studio Code - Mac, Linux, Windows</div><div class="hbc-url">https://code.visualstudio.com/download</div><div class="hbc-description">Visual Studio Code is free and available on your favorite platform - Linux, macOS, and Windows.  Download Visual Studio Code to experience a…</div></div></div></div></a></div></div>

<h2 id="C-Extension"><a href="#C-Extension" class="headerlink" title="C# Extension"></a>C# Extension</h2><p>Visual Studio Code起動後、拡張機能を導入します。 C#はMicrosoftにおける第一級のプログラミング言語ですが、Visual Studio Codeは、クロスプラットフォームで動作するので、そのあたりの特別扱いはできなかった、あるいはIDEではなくエディタという位置づけなので、言語対応は全て拡張機能で追加しましょう、なスタンスのご様子。面倒。<br><a href="../../../../public/2017/04/052c09a990c125f192abcb54c1fb45fd.png"><img src="../../../../public/2017/04/052c09a990c125f192abcb54c1fb45fd-1024x768.png"></a></p>
<h1 id="コーディング"><a href="#コーディング" class="headerlink" title="コーディング"></a>コーディング</h1><p>まず、プロジェクトフォルダを作成します。 Visual Studio Codeでは、プロジェクトという概念がありません。エディタだからですかね。 あるのは、開いたフォルダが起点となるという概念だけです。 今回は<strong>D:\Works\temp\corecli</strong>をプロジェクトフォルダにします。 プロジェクトの作成は、先ほど入手した.NET Coreを使います。 まず、コマンドラインでプロジェクトフォルダに移動します。 続いて、.NET Coreに含まれる<strong>dotnet.exe</strong>を–helpをつけて呼び出します。 [code lang=”cmd”] D:\Works\temp\corecli&gt;”D:\Works\Lib\Microsoft\.NET Core CLI\2.0.0-preview2-005840\bin\dotnet.exe” –help .NET Command Line Tools (2.0.0-preview2-005840) Usage: dotnet [host-options] [command] [arguments] [common-options]<br>Arguments: [command] The command to execute [arguments] Arguments to pass to the command [host-options] Options specific to dotnet (host) [common-options] Options common to all commands<br>Common options: -v|–verbose Enable verbose output -h|–help Show help<br>Host options (passed before the command): -d|–diagnostics Enable diagnostic output –version Display .NET CLI Version Number –info Display .NET CLI Info<br>Commands: new Initialize .NET projects. restore Restore dependencies specified in the .NET project. build Builds a .NET project. publish Publishes a .NET project for deployment (including the runtime). run Compiles and immediately executes a .NET project. test Runs unit tests using the test runner specified in the project. pack Creates a NuGet package. migrate Migrates a project.json based project to a msbuild based project. clean Clean build output(s). sln Modify solution (SLN) files.<br>Project modification commands: add Add items to the project. remove Remove items from the project. list List items in the project.<br>Advanced Commands: nuget Provides additional NuGet commands. msbuild Runs Microsoft Build Engine (MSBuild). vstest Runs Microsoft Test Execution Command Line Tool. [/code] 色々ありますが、<strong>new</strong>でプロジェクトを初期化することがわかります。 ではnewをつけて呼び出します。 [code lang=”cmd”] D:\Works\temp\corecli&gt;”D:\Works\Lib\Microsoft\.NET Core CLI\2.0.0-preview2-005840\bin\dotnet.exe” new Template Instantiation Commands for .NET Core CLI<br>Usage: new [options]<br>Options: -h, –help Displays help for this command. -l, –list Lists templates containing the specified name. If no name is specified, lists all templates. -n, –name The name for the output being created. If no name is specified, the name of the current directory is used. -o, –output Location to place the generated output. -i, –install Installs a source or a template pack. -u, –uninstall Uninstalls a source or a template pack. –type Shows a subset of the available templates. Valid values are “project”, “item” or “other”. –force Forces content to be generated even if it would change existing files. -lang, –language Specifies the language of the template to create.<br>Templates Short Name Language Tags ———————————————————————– Console Application console [C#], F# Common/Console Class library classlib [C#], F# Common/Library Unit Test Project mstest [C#], F# Test/MSTest xUnit Test Project xunit [C#], F# Test/xUnit ASP.NET Core Empty web [C#] Web/Empty ASP.NET Core Web App mvc [C#], F# Web/MVC ASP.NET Core Web API webapi [C#] Web/WebAPI Nuget Config nugetconfig Config Web Config webconfig Config Solution File sln Solution<br>Examples: dotnet new mvc –framework netcoreapp2.0 –auth Individual dotnet new console –framework netcoreapp2.0 dotnet new –help [/code] コンソールアプリは、<strong>console</strong>をつける模様。 最後に、<strong>new console</strong>を付けて実行します。 [code lang=”cmd”] D:\Works\temp\corecli&amp;gt;”D:\Works\Lib\Microsoft\.NET Core CLI\2.0.0-preview2-005840\bin\dotnet.exe” new console The template “Console Application” was created successfully.<br>Processing post-creation actions… Running ‘dotnet restore’ on D:\Works\temp\corecli\corecli.csproj… Restore succeeded. [/code] そうすると、プロジェクトフォルダに、</p>
<ul>
<li>obj</li>
<li>corecli.csproj</li>
<li>NuGet.config</li>
<li>Program.cs</li>
</ul>
<p>が作成されます。 csprojを見ると、Visual Studioを思い出しますが、中身は少し違います。 ファイルへの参照がない。 [code lang=”xhtml”] <Project Sdk="Microsoft.NET.Sdk"><br><PropertyGroup> <OutputType>Exe</OutputType> <TargetFramework>netcoreapp2.0</TargetFramework> </PropertyGroup><br></Project> [/code] 次に、このフォルダをVisual Studio Codeで開きます。メニューに<strong>フォルダーを開く</strong>がありますので、そこから開きます。<br><a href="../../../../public/2017/04/76279b2073aaa126655eb5579cb096a1.png"><img src="../../../../public/2017/04/76279b2073aaa126655eb5579cb096a1-1024x768.png"></a> すると、**Required assets to build and debug are missing from ‘corecli’. Add them?**と聞かれます。 <a href="../../../../public/2017/04/a956c2fecc47c357ed5ade8f7d4668e2.png"><img src="../../../../public/2017/04/a956c2fecc47c357ed5ade8f7d4668e2-1024x768.png"></a><br> Yesと応えると、プロジェクトに</p>
<ul>
<li>.vscode\tasks.json</li>
<li>.vscode\launch.json</li>
</ul>
<p>が追加されます。 同時に、**There are unresolved dependencies from ‘corecli.csproj’. Please execute the restore command to continue.**と聞かれますが、Restoreを選んでも下記のエラーになります。 <code>error: Invalid input &#39;d:\Works\temp\corecli\corecli.csproj&#39;. The file type was not recognized. Done: 1.</code> なので、これは諦めます。</p>
<h1 id="デバッグ-amp-実行"><a href="#デバッグ-amp-実行" class="headerlink" title="デバッグ&amp;実行"></a>デバッグ&amp;実行</h1><p>現時点で、Program.csには、<strong>Hello World!**と表示するコードが書かれています。 これを実行します。 **Console.WriteLine</strong>にF9でブレークポイントを置き、F5で実行してみます。このあたりはVisual Studioと同じで助かります。 実行すると、エラーがでます。<br><a href="../../../../public/2017/04/7d168e1a70d55585dc1f55ad068700cd.png"><img src="../../../../public/2017/04/7d168e1a70d55585dc1f55ad068700cd-1024x768.png"></a> <strong>問題を表示する</strong>とあるのでクリックしますが、 <a href="../../../../public/2017/04/ae09d27d5975a106b62397b00925376d.png"><img src="../../../../public/2017/04/ae09d27d5975a106b62397b00925376d-1024x768.png"></a> <strong>現時点で問題はワークスペースで検出されていません。</strong>と言われます。意味がわかりません。 仕方ないので、もう一度実行し、今度は<strong>このままデバッグを続ける</strong>をクリックします。 すると、今度は下記のメッセージが表示されました。 [code lang=”cmd”] ——————————————————————- You may only use the Microsoft .NET Core Debugger (vsdbg)<br> with Visual Studio Code, Visual Studio or Visual Studio for Mac software to help you develop and test your applications. ——————————————————————- The specified framework ‘Microsoft.NETCore.App’, version ‘2.0.0-preview1-002061-00’ was not found.<br>- Check application dependencies and target a framework version installed at:<br>C:\Program Files\dotnet\shared\Microsoft.NETCore.App<br>- The following versions are installed:<br>1.0.0<br>- Alternatively, install the framework version ‘2.0.0-preview1-002061-00’.<br>The target process exited without raising a CoreCLR started event. Ensure that the target process is configured to use .NET Core. This may be expected if the target process did not run on .NET Core. The program ‘[23568] corecli.dll’ has exited with code -2147450749 (0x80008083). [/code] どうも、依存関係が見つからないご様子。 なので、.NET Core 2.0のフォルダにある、<strong>shared\Microsoft.NETCore.App\2.0.0-preview1-002061-00</strong>を<strong>C:\Program Files\dotnet\shared\Microsoft.NETCore.App</strong>にコピーします。 その後、もう一度F5実行し、<strong>このままデバッグを続ける</strong>をクリックします。 今度は、実行に成功し、ブレークポイントに停止しました。<br><a href="../../../../public/2017/04/bbed7d4da07f33b2a5fe5c237d39b2aa.png"><img src="../../../../public/2017/04/bbed7d4da07f33b2a5fe5c237d39b2aa-1024x768.png"></a><br> カーソルを次に進めると、下のコンソールに**Hello World!**が表示されます。 少し手こずりましたが、何とか動きました。 あと、実行アセンブリは、dllが拡張子なのね…</p>
<h1 id="コンソールからビルド-amp-実行"><a href="#コンソールからビルド-amp-実行" class="headerlink" title="コンソールからビルド&amp;実行"></a>コンソールからビルド&amp;実行</h1><p>Visual Studio Codeから実行しましたが、dotnet.exeからもビルドしてみます。 同じようにカレントをプロジェクトフォルダに移動したコマンドプロンプトから下記でビルドします。 [code lang=”cmd”] D:\Works\temp\corecli&gt;”D:\Works\Lib\Microsoft\.NET Core CLI\2.0.0-preview2-005840\bin\dotnet.exe” build Microsoft (R) Build Engine version 15.2.93.5465 Copyright (C) Microsoft Corporation. All rights reserved.<br>corecli -&gt; D:\Works\temp\corecli\bin\Debug\netcoreapp2.0\corecli.dll<br>Build succeeded. 0 Warning(s) 0 Error(s)<br>Time Elapsed 00:00:02.92 [/code] 続いて実行します。 [code lang=”cmd”] D:\Works\temp\corecli&gt;”D:\Works\Lib\Microsoft\.NET Core CLI\2.0.0-preview2-005840\bin\dotnet.exe” run Hello World! [/code] 問題なく実行できました。 これならLinuxでも実行できそうです。</p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2017-04-23</span><i class="fa fa-tag"></i><a class="tag" href="/categories/Microsoft/" title="Microsoft">Microsoft </a><a class="tag" href="/categories/Microsoft/NET/" title=".NET">.NET </a><a class="tag" href="/categories/Microsoft/NET/Visual-Studio-Code/" title="Visual Studio Code">Visual Studio Code </a><a class="tag" href="/categories/net/" title="net">net </a><a class="tag" href="/categories/net/NET-Core/" title=".NET Core">.NET Core </a><span class="leancloud_visitors"></span></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="" onclick="javascript:join_favorite()" ref="sidebar"></a></div><div class="twitter"><a class="fa fa-twitter" target="_blank" rel="noopener" href="http://twitter.com/home?status=,https://takuya-takeuchi.github.io/2017/04/23/2110/,A certain engineer &quot;COMPLEX&quot;,.NET Core 2.0 PreviewとVisual Studio Codeでコンソールアプリをつくる 準備&amp;作成編,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2017/04/23/2148/" title="ディープラーニング Caffe その3 環境構築 with GPU">前へ</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2017/04/22/2104/" title="開発メモ その53 DockerのベースOSについて">次へ</a></li></ul></div></div></div></div></div><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/js/add-bookmark.js"></script><script src="/js/search.js"></script></body></html>