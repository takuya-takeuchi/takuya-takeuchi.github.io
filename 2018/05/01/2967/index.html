<!DOCTYPE html><html lang="ja-JP"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Core"><link rel="icon" href="/images/favicon.ico" type="image/x-icon"><title>開発メモ その115 nvidia-dockerをUbuntu 18.04にインストールする · A certain engineer "COMPLEX"</title><meta name="description" content="IntroductionUSBメモリにUbuntu 18.04をインストールしたため、Windowsが入っているディスクを汚さずにUbuntuを使えるようになりました。
で、2018年4月26日にリリースされたUbuntu 18.04 LTSをインストールしました。が、情報が少ないせいか、docke"><meta name="keywords"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="stylesheet" href="/css/blogcard.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><script src="/js/jquery.js"></script><meta name="generator" content="Hexo 5.1.0"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.webp" style="width:127px;"><h3 title=""><a href="/">A certain engineer &quot;COMPLEX&quot;</a></h3><div class="description"><p>とある技術者の劣等感</p></div></div></div><ul class="social-links"><li><a target="_blank" rel="noopener" href="https://github.com/takuya-takeuchi"><i class="fa fa-github"></i></a></li><li><a target="_blank" rel="noopener" href="https://twitter.com/takuya_takeuchi"><i class="fa fa-twitter-square"></i></a></li><li><a target="_blank" rel="noopener" href="https://www.facebook.com/takuya.takeuchi.sns"><i class="fa fa-facebook-square"></i></a></li></ul><div class="footer"><div class="p"> <span>© 2020 </span><i class="fa fa-star"></i><span> Core</span></div><div class="by_farbox"><span>Powered by </span><a href="https://hexo.io/" target="_blank">Hexo </a><span> & </span><a href="https://github.com/mrcore/hexo-theme-Anatole-Core" target="_blank">Anatole-Core  </a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="search"><div class="text"><input placeholder="検索ワードを入力してください" id="search-text" onkeypress="javascript:search(event)"></div><div class="btn"><a><i class="fa fa-search"></i></a></div></div><div class="nav"><li><a href="/">ホーム</a></li><li><a href="/archives">アーカイブ</a></li><li><a href="/tags">タグ</a></li><li><a href="/about">自己紹介</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>開発メモ その115 nvidia-dockerをUbuntu 18.04にインストールする</a></h3></div><div class="post-content"><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>USBメモリに<strong>Ubuntu 18.04</strong>をインストールしたため、Windowsが入っているディスクを汚さずにUbuntuを使えるようになりました。</p>
<p>で、2018年4月26日にリリースされた<strong>Ubuntu 18.04 LTS</strong>をインストールしました。<br>が、情報が少ないせいか、dockerがインストールできない!!とか色々…</p>
<p>最初は、<strong>docker-ce</strong>がいるのか!!とか思ってapt-getだ、githubだ、ソースビルドだ、って頑張ったけど、そんなものはいらないことがわかりましした。</p>
<h1 id="Try-out"><a href="#Try-out" class="headerlink" title="Try out!!"></a>Try out!!</h1><p>手順はここに書いてあるとおり。事前にNvidia Driverは入れておきましょう。</p>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># リポジトリを追加</span><br><span class="line">$ curl -s -L https:&#x2F;&#x2F;nvidia.github.io&#x2F;nvidia-docker&#x2F;gpgkey | sudo apt-key add -</span><br><span class="line">$ distribution&#x3D;$(. &#x2F;etc&#x2F;os-release;echo $ID$VERSION_ID)</span><br><span class="line">$ curl -s -L https:&#x2F;&#x2F;nvidia.github.io&#x2F;nvidia-docker&#x2F;$distribution&#x2F;nvidia-docker.list | \</span><br><span class="line">  sudo tee &#x2F;etc&#x2F;apt&#x2F;sources.list.d&#x2F;nvidia-docker.list</span><br><span class="line">$ sudo apt-get update</span><br><span class="line"> </span><br><span class="line"># nvidia-docker2をインストール</span><br><span class="line">$ sudo apt-get install -y nvidia-docker2</span><br><span class="line"># dockerのデーモンを設定して再読込</span><br><span class="line">$ sudo pkill -SIGHUP dockerd</span><br><span class="line"> </span><br><span class="line"># nvidia-smiをコンテナ上で動かす</span><br><span class="line">$ docker run --runtime&#x3D;nvidia --rm nvidia&#x2F;cuda nvidia-smi</span><br></pre></td></tr></table></figure>

<p>これだけです。<br>最後のコマンドを動かすと、グラフィックボードの状態が出力されます。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> docker run --runtime=nvidia --rm nvidia/cuda nvidia-smi</span></span><br><span class="line">Tue May  1 10:58:19 2018</span><br><span class="line">+-----------------------------------------------------------------------------+</span><br><span class="line">| NVIDIA-SMI 390.48                 Driver Version: 390.48                    |</span><br><span class="line">|-------------------------------+----------------------+----------------------+</span><br><span class="line">| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |</span><br><span class="line">| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |</span><br><span class="line">|===============================+======================+======================|</span><br><span class="line">|   0  GeForce GTX 1080    Off  | 00000000:01:00.0  On |                  N/A |</span><br><span class="line">| 27%   33C    P8     7W / 180W |    282MiB /  8117MiB |      0%      Default |</span><br><span class="line">+-------------------------------+----------------------+----------------------+</span><br><span class="line">+-----------------------------------------------------------------------------+</span><br><span class="line">| Processes:                                                       GPU Memory |</span><br><span class="line">|  GPU       PID   Type   Process name                             Usage      |</span><br><span class="line">|=============================================================================|</span><br><span class="line">+-----------------------------------------------------------------------------+</span><br></pre></td></tr></table></figure>

<p>ちなみに、docker-ceの17.12が動いています。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> docker version</span></span><br><span class="line">Client:</span><br><span class="line"> Version:       17.12.1-ce</span><br><span class="line"> API version:   1.35</span><br><span class="line"> Go version:    go1.10.1</span><br><span class="line"> Git commit:    7390fc6</span><br><span class="line"> Built: Wed Apr 18 01:23:11 2018</span><br><span class="line"> OS/Arch:       linux/amd64</span><br><span class="line"> </span><br><span class="line"><span class="meta">$</span><span class="bash"> apt-cache depends nvidia-docker2</span></span><br><span class="line">nvidia-docker2</span><br><span class="line">  依存: nvidia-container-runtime</span><br><span class="line">  依存: docker.io</span><br><span class="line">  破壊: </span><br><span class="line">  置換: </span><br></pre></td></tr></table></figure>

<p>このことは、<a target="_blank" rel="noopener" href="https://github.com/NVIDIA/nvidia-docker/issues/643">Can not install nvidia-docker2 with docker 17.12.0-ce installed #607</a>にも書いてありました。</p>
<blockquote>
<p>Packages released for ubuntu 18.04 today. It depends on docker.io, since docker-ce doesn’t have packages for 18.04 yet. Ubuntu 18.04 向けのパッケージが今日リリースされたよ。docker-ceは18.04向けのパッケージをまだ持っていないから、dockr.ioに依存しているよ。</p>
</blockquote>
<p>でもまぁ。nvidia-dockerが動くようになったので、遠慮無くcudaで遊べます。CUDAのバージョンとか気にしなくて良いので。</p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2018-05-01</span><i class="fa fa-tag"></i><a class="tag" href="/categories/Linux/" title="Linux">Linux </a><a class="tag" href="/categories/仮想化/" title="仮想化">仮想化 </a><a class="tag" href="/categories/Ubuntu/" title="Ubuntu">Ubuntu </a><a class="tag" href="/categories/仮想化/Docker/" title="Docker">Docker </a><span class="leancloud_visitors"></span></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="" onclick="javascript:join_favorite()" ref="sidebar"></a></div><div class="twitter"><a class="fa fa-twitter" target="_blank" rel="noopener" href="http://twitter.com/home?status=,https://takuya-takeuchi.github.io/2018/05/01/2967/,A certain engineer &quot;COMPLEX&quot;,開発メモ その115 nvidia-dockerをUbuntu 18.04にインストールする,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2018/05/01/2981/" title="開発メモ その116 /etc/fstabでホームディレクトリを認識しない">前へ</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2018/05/01/2974/" title="開発メモ その114 Ubuntu 18.04でNvidia Driverをインストールする">次へ</a></li></ul></div></div></div></div></div><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/js/add-bookmark.js"></script><script src="/js/search.js"></script></body></html>