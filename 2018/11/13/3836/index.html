<!DOCTYPE html><html lang="ja-JP"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Core"><title>開発メモ その152 Visual Studio CodeのMarkdown機能を強化 その2 · A certain engineer "COMPLEX"</title><meta name="description" content="Introduction前回の続き。 


どうもMarkdown Preview Enhancedでもヘッダー、フッターの調節ができる模様。 よく考えたら、markdown-pdfと同じpuppeteerを使っているのだから当然と言えば当然なのかな?
ResolutionPuppeteerのインス"><meta name="keywords" content="极限博客,极限Blog,博客,极限"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><script src="/js/jquery.js"></script><meta name="generator" content="Hexo 5.1.0"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">A certain engineer &quot;COMPLEX&quot;</a></h3><div class="description"><p>心之所愿，无事不成。<br> Nothing is impossible to a willing heart.</p></div></div></div><ul class="social-links"><li><a target="_blank" rel="noopener" href="https://github.com/mrcore"><i class="fa fa-github"></i></a></li><li><a href="mailto:x@jixian.io"><i class="fa fa-envelope"></i></a></li><li><a target="_blank" rel="noopener" href="http://sighttp.qq.com/authd?IDKEY="><i class="fa fa-qq"></i></a></li><li><a target="_blank" rel="noopener" href="https://zhihu.com/people/"><i class="fa fa-mortar-board"></i></a></li></ul><div class="footer"><div class="p"> <span>© 2017 - 2020 </span><i class="fa fa-star"></i><span> Core</span></div><div class="by_farbox"><span>Powered by </span><a href="https://hexo.io/" target="_blank">Hexo </a><span> & </span><a href="https://github.com/mrcore/hexo-theme-Anatole-Core" target="_blank">Anatole-Core  </a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">ホーム</a></li><li><a href="/archives">アーカイブ</a></li><li><a href="/tags">タグ</a></li><li><a href="/about">自己紹介</a></li><li><a href="/guestbook">メッセージ</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>開発メモ その152 Visual Studio CodeのMarkdown機能を強化 その2</a></h3></div><div class="post-content"><h1 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h1><p>前回の続き。 </p>


<p>どうも<strong>Markdown Preview Enhanced</strong>でもヘッダー、フッターの調節ができる模様。 よく考えたら、<strong>markdown-pdf</strong>と同じ<strong>puppeteer</strong>を使っているのだから当然と言えば当然なのかな?</p>
<h1 id="Resolution"><a href="#Resolution" class="headerlink" title="Resolution"></a>Resolution</h1><h2 id="Puppeteerのインストール"><a href="#Puppeteerのインストール" class="headerlink" title="Puppeteerのインストール"></a>Puppeteerのインストール</h2><p>前回は省略したので。 <strong>Chocolately</strong>が入っているとインストールが簡単です。 </p>
<div class="blog-card"><div class="hbc-link-wrap"><a class="hbc-link" href="https://chocolatey.org/" target="_blank" rel="nofollow"><div class="hbc-card"><div class="hbc-info"><img class="hbc-favicon" src="http://www.google.com/s2/favicons?domain=chocolatey.org"></img><div class="hbc-site-name">Chocolatey</div></div><div class="hbc-contents"><div class="hbc-thumbnail"><img src="https://chocolatey.org/content/images/icon_slogan.png"></img></div><div class="hbc-text"><div class="hbc-title">Chocolatey - The package manager for Windows</div><div class="hbc-url">https://chocolatey.org/</div><div class="hbc-description">Chocolatey is software management automation for Windows that wraps installers, executables, zips, and scripts into compiled packages. Choco…</div></div></div></div></a></div></div>

<p>管理者でコンソールを起動します。 [code lang=”ps”] $ choco install nodejs /y Chocolatey v0.10.10 Installing the following packages: nodejs By installing you accept licenses for the packages. Progress: Downloading nodejs 10.13.0… 100%<br>nodejs.install v10.13.0 [Approved] nodejs.install package files install completed. Performing other installation steps. Installing 64 bit version Installing nodejs.install… nodejs.install has been installed. nodejs.install may be able to be automatically uninstalled. Environment Vars (like PATH) have changed. Close/reopen your shell to see the changes (or in powershell/cmd.exe just type `refreshenv`). The install of nodejs.install was successful. Software installed as ‘msi’, install location is likely default.<br>nodejs v10.13.0 [Approved] nodejs package files install completed. Performing other installation steps. The install of nodejs was successful. Software install location not explicitly set, could be in package or default install location if installer.<br>Chocolatey installed 2/2 packages. See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log). [/code] 続いて<strong>Node.js command prompt</strong>を起動します。 [code lang=”dos”] &gt; npm install -g puppeteer<br>&gt; puppeteer@1.10.0 install C:\Users\TAKUYA\AppData\Roaming\npm\node_modules\puppeteer &gt; node install.js<br>Downloading Chromium r599821 - 135.9 Mb [====================] 99% 0.0s Chromium downloaded to C:\Users\TAKUYA\AppData\Roaming\npm\node_modules\puppeteer\.local-chromium\win64-599821 + <a href="mailto:&#112;&#117;&#112;&#112;&#101;&#116;&#x65;&#x65;&#x72;&#64;&#x31;&#46;&#x31;&#x30;&#x2e;&#48;">&#112;&#117;&#112;&#112;&#101;&#116;&#x65;&#x65;&#x72;&#64;&#x31;&#46;&#x31;&#x30;&#x2e;&#48;</a> added 42 packages from 22 contributors in 17.873s [/code] <strong>-g</strong>オプション必須です。 起動中の<strong>Visual Studio Code</strong>は再起動します。でないとpuppeteerが反映されません。</p>
<h2 id="ヘッダー・フッターを付与する"><a href="#ヘッダー・フッターを付与する" class="headerlink" title="ヘッダー・フッターを付与する"></a>ヘッダー・フッターを付与する</h2><p>Markdownファイルの先頭に下記のような記述を追記。 [code lang=”markdown”] — puppeteer: displayHeaderFooter: true headerTemplate: “<span>This is header</span>“ footerTemplate: “<span>This is footer</span>“ — [/code] ただし、デフォルトだと出力文字がすごく小さい。 この領域は、タグが使える。なので下記のようにフォントを使って調整可能。 [code lang=”markdown”] — puppeteer: displayHeaderFooter: true headerTemplate: “&lt;div style=\“font-size: 9px; margin-left: 1cm;\“&gt; <span>This is header</span></div>“ footerTemplate: “<span>This is footer</span>“ — [/code] ヘッダー・フッターにはテンプレートが使える。</p>
<p>定義</p>
<p>意味</p>
<p>使用例</p>
<p>date</p>
<p>日付</p>
<p><span class='date'></span></p>
<p>title</p>
<p>ファイル名</p>
<p><span class='title'></span></p>
<p>url</p>
<p>フルパスファイル名</p>
<p><span class='url'></span></p>
<p>pageNumber</p>
<p>現在のページ番号</p>
<p><span class='pageNumber'></span></p>
<p>totalPages</p>
<p>ドキュメントの総ページ数</p>
<p><span class='totalPages'></span></p>
<h2 id="背景を印刷する"><a href="#背景を印刷する" class="headerlink" title="背景を印刷する"></a>背景を印刷する</h2><p>前回言及したコードハイライトのブロックの背景が白くなる問題の解決。 [code lang=”markdown”] — puppeteer: printBackground : true — [/code]</p>
<h2 id="日本語が文字化け"><a href="#日本語が文字化け" class="headerlink" title="日本語が文字化け"></a>日本語が文字化け</h2><p>フォントの問題と思われる。</p>
<p><a href="../../../../public/2018/11/1-2.png"><img src="../../../../public/2018/11/1-2-300x277.png"></a><br> プレビュー</p>
<p><a href="../../../../public/2018/11/2-1.png"><img src="../../../../public/2018/11/2-1-236x300.png"></a><br> PDF出力</p>
<p>中国語フォントっぽいなぁ… ただ、puppeteerのバージョンの問題という情報が。 </p>
<div class="blog-card"><div class="hbc-link-wrap"><a class="hbc-link" href="https://uyamazak.hatenablog.com/entry/2018/11/09/131009" target="_blank" rel="nofollow"><div class="hbc-card"><div class="hbc-info"><img class="hbc-favicon" src="http://www.google.com/s2/favicons?domain=uyamazak.hatenablog.com"></img><div class="hbc-site-name">GAミント至上主義</div></div><div class="hbc-contents"><div class="hbc-thumbnail"><img src="https://cdn-ak.f.st-hatena.com/images/fotolife/u/uyamazak/20181109/20181109130551.png"></img></div><div class="hbc-text"><div class="hbc-title">【解決】puppeteerを1.10にするとPDFの日本語が文字化けする問題 - GAミント至上主義</div><div class="hbc-url">https://uyamazak.hatenablog.com/entry/2018/11/09/131009</div><div class="hbc-description">2018/11/13 追記 結論 Chromium 72.0.3606.0(Developer Build)を使ったところ直ったので、次のバージョン（1.11）では直るはず。 そのため1.10をスキップするだけで問題は解決しそう。追記ここまで yagish履歴書のHTML→PDF…</div></div></div></div></a></div></div>

<p>1.10.0が問題とのことなので1.9.0に戻してみる。 [code lang=”dos”] &gt; npm install -g <a href="mailto:&#x70;&#117;&#x70;&#x70;&#101;&#x74;&#101;&#101;&#114;&#x40;&#x31;&#46;&#57;&#46;&#48;">&#x70;&#117;&#x70;&#x70;&#101;&#x74;&#101;&#101;&#114;&#x40;&#x31;&#46;&#57;&#46;&#48;</a> [/code] 直りました。<br><a href="../../../../public/2018/11/3-1.png"><img src="../../../../public/2018/11/3-1-236x300.png"></a></p>
<h2 id="フォント変更"><a href="#フォント変更" class="headerlink" title="フォント変更"></a>フォント変更</h2><p>前回との同じくCSSをカスタマイズします。 [code] .markdown-preview.markdown-preview { // modify your style here // eg: background-color: blue;<br>h1, h2, h3, h4, h5, h6, p { font-family: ‘ヒラギノ丸ゴ ProN W4’, ‘游ゴシック体’, ‘Yu Gothic’, ‘YuGothic’, ‘ヒラギノ角ゴシック Pro’, ‘Hiragino Kaku Gothic Pro’, ‘ＭＳ　Ｐゴシック’, ‘MS PGothic’, sans-serif; } } [/code]<br><a href="../../../../public/2018/11/4-1.png"><img src="../../../../public/2018/11/4-1-236x300.png"></a></p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2018-11-13</span><i class="fa fa-tag"></i><a class="tag" href="/categories/Microsoft/" title="Microsoft">Microsoft </a><a class="tag" href="/categories/Microsoft/Visual-Studio-Code/" title="Visual Studio Code">Visual Studio Code </a><span class="leancloud_visitors"></span></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="" onclick="javascript:join_favorite()" ref="sidebar"></a></div><div class="twitter"><a class="fa fa-twitter" target="_blank" rel="noopener" href="http://twitter.com/home?status=,https://takuya-takeuchi.github.io/2018/11/13/3836/,A certain engineer &quot;COMPLEX&quot;,開発メモ その152 Visual Studio CodeのMarkdown機能を強化 その2,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2018/11/13/3860/" title="開発メモ その153 Visual Studio CodeのMarkdown機能を強化 その3">前へ</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2018/11/12/3825/" title="開発メモ その151 Visual Studio CodeのMarkdown機能を強化">次へ</a></li></ul></div></div></div></div></div><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/js/add-bookmark.js"></script></body></html>