<!DOCTYPE html><html lang="ja-JP"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Core"><title>BitNami Redmine Stack 2.1.2-0にRedmine Backlogsをインストールする · A certain engineer "COMPLEX"</title><meta name="description" content="スクラム開発ってのが流行っている、というのでせっかくのBTS、Redmineを使って導入できないか？って調べたらプラグインがあるようなので導入してみた。 が、結構道のりは長かった。長かった。 ですので、多大な時間を労するのは、私だけで良いんです。これを見ている方々には、「ここは俺に任せてお前らは先に"><meta name="keywords"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><script src="/js/jquery.js"></script><meta name="generator" content="Hexo 5.1.0"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">A certain engineer &quot;COMPLEX&quot;</a></h3><div class="description"><p>とある技術者の劣等感</p></div></div></div><ul class="social-links"><li><a target="_blank" rel="noopener" href="https://github.com/takuya-takeuchi"><i class="fa fa-github"></i></a></li><li><a target="_blank" rel="noopener" href="https://twitter.com/takuya_takeuchi"><i class="fa fa-twitter-square"></i></a></li><li><a target="_blank" rel="noopener" href="https://www.facebook.com/takuya.takeuchi.sns"><i class="fa fa-facebook-square"></i></a></li></ul><div class="footer"><div class="p"> <span>© 2020 </span><i class="fa fa-star"></i><span> Core</span></div><div class="by_farbox"><span>Powered by </span><a href="https://hexo.io/" target="_blank">Hexo </a><span> & </span><a href="https://github.com/mrcore/hexo-theme-Anatole-Core" target="_blank">Anatole-Core  </a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">ホーム</a></li><li><a href="/archives">アーカイブ</a></li><li><a href="/tags">タグ</a></li><li><a href="/about">自己紹介</a></li><li><a href="/guestbook">メッセージ</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>BitNami Redmine Stack 2.1.2-0にRedmine Backlogsをインストールする</a></h3></div><div class="post-content"><p><strong>スクラム開発</strong>ってのが流行っている、というのでせっかくのBTS、<strong>Redmine</strong>を使って導入できないか？って調べたらプラグインがあるようなので導入してみた。 が、結構道のりは長かった。長かった。 ですので、多大な時間を労するのは、私だけで良いんです。これを見ている方々には、<strong>「ここは俺に任せてお前らは先に行け！」</strong> と言わせていただきたいwww</p>
<a id="more"></a>
<p>阿呆なコメントはさておき。 この記事の目標は簡単にスクラム環境をRedmineに導入するプラグイン<strong>Redmine Backlogs</strong>を簡単にインストールする事です。 たかがプラグインと思っていると躓きます。結構面倒です。というか、Redmineのプラグインは何かあると、<strong>すぐにRedmine本体が動かなくなります</strong>から本当に困ります。 導入対象環境は<strong>BitNami Redmine Stack 2.1.2-0</strong>です。 最新のバージョンは<strong>BitNami Redmine Stack 2.1.2-2</strong>ですが、これへの導入は失敗しました。 なんせ、既存のプラグインすら動かなくなった、どころかログインはできるが、その後の画面がすべて<strong>404</strong>とかなにそれwww なので対象環境は<strong>BitNami Redmine Stack 2.1.2-0</strong>です。間違えないように。 では早速。 まずは下準備。</p>
<ol>
<li>必要なファイルをバックアップ</li>
<li>既存のBitNami Redmine Stackを一度アンインストール</li>
<li>インストール先はファイルパスに空白が含まれないこと (ここでは<strong>C:\BitNami\Redmine</strong>として説明します)</li>
<li>新しいBitNami Redmine Stackをインストール</li>
<li>バックアップから復元 (ただし、プラグインは復元しない)</li>
</ol>
<p>という手順まで終えてください。 つまりクリーンな環境にインストールすることを前提とします。 インストール先は、<a target="_blank" rel="noopener" href="https://taktak.jp/wordpress/?p=302">前回</a>と同じくファイルパスに空白が含まれない場所にします。 では早速。 (1) システムにパスを通します。<strong>システムのプロパティ-&gt;詳細設定-&gt;環境変数</strong>と進み、<strong>ユーザー環境変数</strong>に下記を追加します。 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RAILS\_ENV&#x3D;production PATH&#x3D;C:\\BitNami\\Redmine\\ruby\\bin;C:\\BitNami\\Redmine\\imagemagic </span><br></pre></td></tr></table></figure>

<p><strong>PATH</strong>の<strong>C:\BitNami\Redmine\</strong>の部分は<strong>BitNami Redmine Stack</strong>のインストール先になりますので、適宜置き換えてください。 <strong>PATH</strong>は既存の値の後ろに追加することになります。従って、PATHの既存の値が </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\\Program Files (x86)\\Visual Studio 2005 SDK\\2007.02\\VisualStudioIntegration\\Tools\\Sandcastle\\ProductionTools\\; </span><br></pre></td></tr></table></figure>

<p>なら、 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">C:\\Program Files (x86)\\Visual Studio 2005 SDK\\2007.02\\VisualStudioIntegration\\Tools\\Sandcastle\\ProductionTools\\;C:\\BitNami\\Redmine\\ruby\\bin;C:\\BitNami\\Redmine\\imagemagick </span><br></pre></td></tr></table></figure>

<p>になります。既存の値の末尾に <strong>;</strong> をつけてから、前述の値を追加することになります。終わったら<strong>OK-&gt;OK</strong>でプロパティを終了します。 (2) <strong>Ruby Development Kit</strong>をダウンロードします。<a target="_blank" rel="noopener" href="http://rubyinstaller.org/downloads/">このページ</a>からダウンロードします。最新版は<strong>DevKit-tdm-32-4.5.2-20111229-1559-sfx.exe</strong>になります。 (3) ダウンロードしたファイルを展開します。</p>
<p><a href="../../../../public/2012/11/Extract.png"><img src="../../../../public/2012/11/Extract-300x121.png" title="Extract"></a></p>
<p>このようなウィンドウが開くのでRuby Development Kitを展開したいフォルダパスを指定します。ここも空白が含まれるパスは避けた方が無難です。ここでは、<strong>C:\BitNami\Redmine\DevKit</strong>にインストールします。 (4) <strong>スタートメニュー-&gt;BitNami Redmine Stack-&gt;Use BitNami Redmine Stack</strong> でコマンドプロンプトを起動。以下のコマンドを順次実行。 </p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> DevKit ruby dk.rb init </span><br></pre></td></tr></table></figure>

<p>すると、 </p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Initialization complete! Please review and modify the auto-generated &#x27;config.yml&#x27; file to ensure it contains the root directories to all of the installed Rubies you want enhanced by the DevKit. </span><br></pre></td></tr></table></figure>

<p>と出ます。 コマンドプロンプトはそのまま開いたままで。 (5) <strong>C:\BitNami\Redmine\DevKit</strong>に<strong>config.yml</strong>が生成されたはずなのでテキストファイルで開きます。 (6) 末尾に<strong>ruby</strong>のインストール先を追記します。rubyのインストール先は<strong>BitNami Redmine Stack</strong>の直下なので、 </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="string">C:\\BitNami\\Redmine\\ruby</span> </span><br></pre></td></tr></table></figure>

<p>のように追記してください。 (7) 以下のコマンドを順次実行。 </p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby dk.rb install </span><br></pre></td></tr></table></figure>

<p>すると、 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">\[INFO\] Updating convenience notice gem override for &#39;C:&#x2F;BitNami&#x2F;Redmine&#x2F;ruby&#39; \[INFO\] Installing &#39;C:&#x2F;BitNami&#x2F;Redmine&#x2F;ruby&#x2F;lib&#x2F;ruby&#x2F;site\_ruby&#x2F;devkit.rb&#39;. </span><br></pre></td></tr></table></figure>

<p>と出ます。 コマンドプロンプトはそのまま開いたままで。 これで<strong>Ruby Development Kit</strong>のインストールは完了です。 次に<strong>Redmine Backlogs</strong>をインストールします。 (7) 以下のコマンドを順次実行。 </p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ..\\apps\\redmine\\htdocs\\plugins git clone https://github.com/backlogs/redmine\_backlogs.git </span><br></pre></td></tr></table></figure>

<p>(8) <strong>C:\BitNami\Redmine\apps\redmine\htdocs\plugins</strong>の直下に<strong>redmine_backlogs</strong>フォルダがあるので、その直下の<strong>Gemfile</strong>というファイルをテキストエディタで開きます。 (9) 40行目を下記のように変更します。 </p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">- gem &quot;gherkin&quot;, &quot;=2.6.8&quot; + gem &quot;gherkin&quot; </span></span><br></pre></td></tr></table></figure>

<p>(10) 61行目を削除します。 </p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">- gem &quot;spork&quot; - gem &quot;test-unit&quot;, &quot;=1.2.3&quot; if RUBY\_VERSION &gt;= &quot;1.9&quot; - gem &quot;timecop&quot;, &#x27;~&gt; 0.3.5&#x27; + gem &quot;spork&quot; + gem &quot;timecop&quot;, &#x27;~&gt; 0.3.5&#x27; </span></span><br></pre></td></tr></table></figure>

<p>(11) 以下のコマンドを実行。 </p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem source --add http://production.s3.rubygems.org </span><br></pre></td></tr></table></figure>

<p>このコマンドは実行する必要はありませんが、この記事を書いた時点で、gemのインストールパッケージを保持しているミラーサイトが死んでいたので、日本のIPからはインストールできませんでしたのでその回避策です。<a target="_blank" rel="noopener" href="http://toriniku.hatenablog.com/entry/2012/09/11/164446" title="鶏肉がいいよね。">toyko-m.rubygems.orgがエラー</a>を参考にさせて頂きました。ありがとうございます。 (12) 以下のコマンドを順次実行。<strong>gem</strong>を順次インストールします。<strong>bundle</strong>を使わないのはそれで失敗したからです。時間がかかるのでお茶でも飲んでてください。 </p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem install timecop -v <span class="number">0</span>.<span class="number">3</span>.<span class="number">5</span> gem install simplecov -v <span class="number">0</span>.<span class="number">6</span>.<span class="number">0</span> gem install icalendar gem install holidays -v <span class="number">1</span>.<span class="number">0</span>.<span class="number">3</span> gem install holidays gem install spork gem install open-uri-cached gem install prawn gem install inifile gem install spork gem install ZenTest -v <span class="number">4</span>.<span class="number">5</span>.<span class="number">0</span> gem install autotest-rails gem install capybara gem install cucumber-rails gem install culerity gem install database\_cleaner gem install hoe -v <span class="number">1</span>.<span class="number">5</span>.<span class="number">1</span> gem install poltergeist -v <span class="number">0</span>.<span class="number">6</span>.<span class="number">0</span> gem install rspec-rails -v <span class="number">2</span>.<span class="number">11</span>.<span class="number">0</span> gem install rcov -v <span class="number">0</span>.<span class="number">9</span>.<span class="number">11</span> gem install poltergeist -v <span class="number">0</span>.<span class="number">6</span>.<span class="number">0</span> gem install redgreen </span><br></pre></td></tr></table></figure>

<p><strong>holidays</strong>が2回あるのは意図的です。<strong>Redmine Backlogs</strong>の公式ページでの<a target="_blank" rel="noopener" href="http://www.redminebacklogs.net/en/installation.html">インストール方法説明ページ</a>に </p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">There is currently a known problem with the installer <span class="keyword">for</span> the holidays gem (<span class="number">1</span>.<span class="number">0</span>.<span class="number">4</span>)</span><br><span class="line">. You can work around the problem by first installing an older version and then upgrading:  </span><br><span class="line">gem install holidays --version <span class="number">1</span>.<span class="number">0</span>.<span class="number">3</span> gem install holidays </span><br></pre></td></tr></table></figure>

<p><strong>訳: holidays gem (1.0.4)のインストーラには既知の問題がある。まず古いバージョンをインストールし、それからアップデートすると上手く問題に対処できる。</strong> と記載してあるためです。 (13) gemのインストールが上手くいきました。以下のコマンドを順次実行。 </p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bundle exec rake redmine:plugins:migrate RAILS\_ENV=production bundle exec rake tmp:cache:clear bundle exec rake tmp:sessions:clear </span><br></pre></td></tr></table></figure>

<p>この時点で、<strong>Could not find gem ～</strong>とか表示せず、<strong>Migrating redmine_backlogs (Redmine Backlogs)…**という表示から大量のログが出力されていたら成功です。</strong>Redmine Backlogs<strong>のインストールの</strong>下準備<strong>が。 (14) **下準備</strong>が終わりましたので、<strong>Redmine Backlogs</strong>をインストールします。以下のコマンドを実行。 </p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bundle exec rake redmine:backlogs:install RAILS\_ENV=production </span><br></pre></td></tr></table></figure>

<p>すると、 </p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">C:\\<span class="title">BitNami</span>\\<span class="title">Redmine</span>\\<span class="title">apps</span>\\<span class="title">redmine</span>\\<span class="title">htdocs</span>\\<span class="title">plugins</span>&gt;<span class="title">bundle</span> <span class="title">exec</span> <span class="title">rake</span> <span class="title">redmine:backlogs</span> :<span class="title">install</span> <span class="title">RAILS</span>\<span class="title">_ENV</span>=<span class="title">production</span> (<span class="title">in</span> <span class="title">C</span>:/<span class="title">BitNami</span>/<span class="title">Redmine</span>/<span class="title">apps</span>/<span class="title">redmine</span>/<span class="title">htdocs</span>) <span class="title">You</span> <span class="title">are</span> <span class="title">running</span> <span class="title">backlogs</span> <span class="title">v0</span>.9.26, <span class="title">latest</span> <span class="title">version</span> <span class="title">is</span> 0.9.26  </span></span><br><span class="line"><span class="function">\===================================================== <span class="title">Redmine</span> <span class="title">Backlogs</span> <span class="title">Installer</span> ===================================================== <span class="title">Installing</span> <span class="title">to</span> <span class="title">the</span> <span class="title">production</span> <span class="title">environment</span>. <span class="title">Fetching</span> <span class="title">card</span> <span class="title">labels</span> <span class="title">from</span> <span class="title">http</span>://<span class="title">git.gnome.org</span>...<span class="title">done</span>! <span class="title">Configuring</span> <span class="title">story</span> <span class="title">and</span> <span class="title">task</span> <span class="title">trackers</span>... ----------------------------------------------------- <span class="title">Which</span> <span class="title">trackers</span> <span class="title">do</span> <span class="title">you</span> <span class="title">want</span> <span class="title">to</span> <span class="title">use</span> <span class="title">for</span> <span class="title">your</span> <span class="title">stories</span>? 1. 繝舌げ 2. 讖溯・ 3. 繧ｵ繝昴・繝 <span class="title">Separate</span> <span class="title">values</span> <span class="title">with</span> <span class="title">a</span> <span class="title">space</span> (<span class="title">e.g</span>. 1 3): </span></span><br></pre></td></tr></table></figure>

<p>のような表示が出ます。文字化けしています。実は、<strong>BitNami Redmine Stack 2.1.2-2</strong>でインストールすると文字化けしていません。というのも、<strong>BitNami Redmine Stack 2.1.2-2</strong>から<strong>Ruby Development Kit</strong>がデフォルトでインストールされるようになりました。その所為かもしれません。<strong>BitNami Redmine Stack 2.1.2-1</strong>は知りません。 (15) 文字化け部分は上から<strong>バグ、機能、サポート</strong>と表示されています。多分これは環境によって変わります。今回は新規インストールに等しいからかもしれません。これは後から変更できるので、とりあえず </p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="number">2</span> <span class="number">3</span> </span><br></pre></td></tr></table></figure>

<p>と入力します。すると、 </p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You selected the following trackers: 繝舌げ, 讖溯・, 繧ｵ繝昴・繝・ Is this corre ct? (y/n) </span><br></pre></td></tr></table></figure>

<p>と出るので、 </p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">y </span><br></pre></td></tr></table></figure>

<p>(16) 下記の質問が表示されます。 </p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">----------------------------------------------------- Creating a new task tracker. Please <span class="built_in">type</span> the tracker&#x27;s name: </span><br></pre></td></tr></table></figure>

<p>とりあえず、 </p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Task </span><br></pre></td></tr></table></figure>

<p>と入力します。すると、 </p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You typed &#x27;Task&#x27;. Is this correct? (y/n) </span><br></pre></td></tr></table></figure>

<p>と出るので、 </p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">y </span><br></pre></td></tr></table></figure>

<p>とすると、しばらく処理待ちになりますのでココアでも飲んで待ちましょう。(途中でEnterキーを押す必要があったかも…) </p>
<figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Installation complete. Please restart Redmine. Thank you <span class="keyword">for</span> trying out Redmine Backlogs! </span><br></pre></td></tr></table></figure>

<p>と出たら終了です。 (17) 最後の指示通り、<strong>Redmine</strong>を再起動します。<strong>Manager tool</strong>から<strong>Restart All</strong>で<strong>ポチっ</strong>となって感じで再起動してください。 (18) Redmineにログインすると、<strong>スクラム統計</strong>ってのが見えるはずです。プラグインの設定から先ほどの文字化けしていたトラッカーの選択は変更できます。 以上で終了です。お疲れ様でした。 最新の<strong>BitNami Redmine Stack</strong>にインストールする、という目標は達成できました。 Redmineへのインストールはいろいろな方が挑戦していますが、<strong>普通のRedmine</strong>だったり、<strong>ALMinium</strong>だったり、<strong>BitNami Redmine Stack</strong>の<strong>2.0.X</strong>や<strong>1.4.0</strong>とかだったりして挑戦する勇気や生贄が不足していました。 ですが、これで<strong>BitNami Redmine Stack 2.1.2-0</strong>へのインストールは大丈夫でしょう。 願わくばこの記事がお役に立てることを。</p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2012-11-18</span><i class="fa fa-tag"></i><a class="tag" href="/categories/プロジェクト管理/" title="プロジェクト管理">プロジェクト管理 </a><a class="tag" href="/categories/ソフトウェア紹介/" title="ソフトウェア紹介">ソフトウェア紹介 </a><a class="tag" href="/categories/プロジェクト管理/Redmine/" title="Redmine">Redmine </a><a class="tag" href="/categories/ソフトウェア工学/" title="ソフトウェア工学">ソフトウェア工学 </a><span class="leancloud_visitors"></span></div></div></div></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="" onclick="javascript:join_favorite()" ref="sidebar"></a></div><div class="twitter"><a class="fa fa-twitter" target="_blank" rel="noopener" href="http://twitter.com/home?status=,https://takuya-takeuchi.github.io/2012/11/18/307/,A certain engineer &quot;COMPLEX&quot;,BitNami Redmine Stack 2.1.2-0にRedmine Backlogsをインストールする,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2012/12/01/323/" title="BitNami Redmine Stack のチケットに添付画像のサムネイルが表示されないのを修正する">前へ</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2012/10/13/302/" title="BitNami Redmine Statck が起動しない...だと... (解決編)">次へ</a></li></ul></div></div></div></div></div><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/js/add-bookmark.js"></script></body></html>